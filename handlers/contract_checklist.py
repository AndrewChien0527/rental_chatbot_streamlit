import streamlit as st


def add_chat(role, content):
    with st.chat_message(role):
        st.markdown(content)
    st.session_state.messages.append({"role": role, "content": content})


def handle_contract_checklist():
    
    add_chat("assistant", '''檢查房東是否有權出租、是否有白紙黑字、違法條款（如不給報稅）、水電計費方式等。✅ 租約簽訂前的檢查清單
🏠 一、房屋與房東資訊確認
房東身分是否為屋主？

請房東出示「房屋權狀」或「房屋稅單」，核對姓名與地址。

若對方為二房東，要確認他是否有「轉租權」（主契約中須明載可轉租）。

房屋用途是否合法？

可到地政事務所或使用「內政部不動產資訊平台」查詢土地使用分區。

若是違建（如鐵皮加蓋、陽台外推、分間套房），居住安全與未來權益有風險。

有無其他共有人或繼承人？

如房屋共有多人，應確保所有共有人均同意出租，否則未來可能發生糾紛。

🧾 二、租約內容預先審閱
使用政府定型化租賃契約

內政部提供的版本對房客較有保障，可避免「霸王條款」。

可在簽約前主動要求以此為本。

重點條文檢查

租期長短與起止日期

租金金額與支付方式（現金、匯款）

押金金額（最多為兩個月）

水電、瓦斯、網路費計算方式與繳費責任

提前解約與違約金的規定

修繕責任分配（建議大修由房東負責，小修由房客處理）

簽約人需與產權人一致

契約雙方姓名應與房屋權狀相符，避免之後房東否認合約效力。

🏚️ 三、房屋現況檢查與紀錄
設備功能測試

水壓、水溫、插座、電燈、電器（冷氣、冰箱、熱水器）都要測試運作狀況。

拍照或錄影存證

對牆壁、地板、窗戶、家具的損耗或污損處拍照保存，避免退租時被誣指損壞。

設備清單

詳列房內家具與電器清單，可附於租約後頁，雙方簽名認可。

🧍‍♂️ 四、實地觀察周邊與鄰居
鄰近是否有噪音、異味、風化戶、非法行業？

房東是否住同棟？管理方式如何？

是否可登記戶籍？是否開立租金報稅收據？

📌 簽約當日注意事項
確認契約內容無誤再簽名。

雙方各自保留一份原始簽署的契約正本。

收押金、首期租金時應要求開立收據，載明金額與用途。''')
    if "post_input" not in st.session_state:
        st.session_state.post_input = ""

    if not st.session_state.post_input:
        user_text = st.chat_input(" ")
        if user_text:
            st.session_state.post_input = user_text
            return f"收到：\n\n🧐 分析中……（你提供的是：{user_text})"
        else:
            return "請提供事實內容，我才能幫你判斷是否有風險。"
    else:
        # simulate analysis
        return "✅ 根據你提供的資訊，以下是建議您的應對方式。"